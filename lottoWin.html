<!DOCTYPE html>
<html>
<head lang="en">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1">
    <meta charset="UTF-8">
    <title>로또당첨번호확률계산기</title>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <script type="text/javascript">
        $(function(){
            $('select').addClass("form-control");
            $('.label').css('font-size','82%');

            for(var i =1 ; i <= 7 ; i ++){
                for(var k = 1 ; k <= 45 ; k ++){
                    $("#hold"+i).append("<option value='"+k+"'>"+k);
                    $("#win"+i).append("<option value='"+k+"'>"+k);
                }
            }

            $('#saveWinBtn').on('click',function(){
                createWinNums();
            });

            $('#reloadWinBtn').on('click',function(){
                for(var i = 1 ; i <= 7 ; i ++){
                        $("#win"+i).val("");
                }
                createWinNums();
            });

            $('#resetBtn').on('click',function(){
                location.reload();
            });

           $('#startBtn').on('click',function(){
               $('#winHold').hide();
               if(lottoInterval != null){
                   return;
               }
               else{
                   lottoInterval = setInterval(function(){
                       var randNums = createRandomNums();
                       displayNums('nowNums',randNums);
                       if(checkNums(randNums)){
                           $('#stopBtn').click();
                       }
                       displayWinMoney();
                       displayLoseMoney();
                   },5);
               }
           });
           $('#stopBtn').on('click',function(){
               $('#winHold').show();
               if(lottoInterval != null){
                   clearInterval(lottoInterval);
                   lottoInterval = null;
               }
            });

            $('#reloadWinBtn').click();
        });

        var realNums = null;
        var bonus = 0;
        var count = 0;
        var lottoInterval = null;

        function createWinNums(){
            realNums = new Array();
            for(var i =1 ; i <= 7 ; i ++){
                if($("#win"+i).val() != ""){
                    if(i != 7 ){
                        realNums.push(parseInt($("#win"+i).val()));
                    }else{
                        bonus = parseInt($("#win"+i).val());
                    }
                }else{
                    var num = createRandomNum();
                    while(realNums.contains(num)){
                        num = createRandomNum();
                    }
                    if(i != 7 ){
                        realNums.push(num);
                    }else{
                       bonus = num;
                    }
                }
            }

            realNums.sort(function(a,b){return a-b;});

            for(var i = 1 ; i <= 7 ; i ++){
                if(i != 7 ){
                    $("#win"+i).val(realNums[(i-1)]);
                }else{
                    $("#win"+i).val(bonus);
                }
            }

            displayNums('realNums',realNums);
        }

        function createRandomNums(){
            var randNums = new Array();
            for(var i =1 ; i <= 6 ; i ++){
                if($("#hold"+i).val() != ""){
                    randNums.push(parseInt($("#hold"+i).val()));
                }
            }
            if(randNums.length == 6)
                return  randNums.sort(function(a,b){return a - b;});

            while(true){
                var num = createRandomNum();
                while(randNums.contains(num)){
                    num = createRandomNum();
                }
                randNums.push(num);
                if(randNums.length == 6)
                    return  randNums.sort(function(a,b){return a - b;});
            }
        }

        function createRandomNum(){
            return parseInt((Math.random() *45)+1);
        }

        function checkNums(randNums){
            $('#count').text(++count);
            $('#money').text((count * 1000).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + ' 원');
            var ranking = 0;
            for(var i = 0 ; i < 6 ; i ++){
                if(realNums.contains(randNums[i])){
                    ranking++;
                }
            }

            var five = parseInt($('#five').text());
            var four = parseInt($('#four').text());
            var three = parseInt($('#three').text());
            var two = parseInt($('#two').text());
            var one = parseInt($('#one').text());
            var none = parseInt($('#none').text());

            switch (ranking){
                case 3:
                    $('#five').text(++five);
                    displayNums('fiveMatch',randNums);
                    break;
                case 4:
                    $('#four').text(++four);
                    displayNums('fourMatch',randNums);
                    break;
                case 5:
                    if(randNums.contains(bonus)){
                        $('#two').text(++two);
                        displayNums('twoMatch',randNums);
                    }
                    else{
                        $('#three').text(++three);
                        displayNums('threeMatch',randNums);
                    }
                    break;
                case 6:
                    $('#one').text(++one);
                    displayNums('oneMatch',randNums);
                    break;
                default :
                    $('#none').text(++none);
                    break;
            }

            $('#fivePer').text((five/count * 100).toFixed(6) + ' %');
            $('#fourPer').text((four/count * 100).toFixed(6) + ' %');
            $('#threePer').text((three/count * 100).toFixed(6) + ' %');
            $('#twoPer').text((two/count * 100).toFixed(6) + ' %');
            $('#onePer').text((one/count * 100).toFixed(6) + ' %');
            $('#nonePer').text((none/count * 100).toFixed(6) + ' %');

            for(var i = 0 ; i < 6 ; i ++){
                if(!realNums.contains(randNums[i])){
                    return false;
                }
            }
            return true;
        }

        function displayNums(id,nums){
            var text = "";
            for(var i = 0 ; i < 6 ; i ++){
                text += nums[i];
                if(i<5)text += ", ";
            }
            if(id == 'realNums')text += " 보너스 : " + bonus;
            $('#'+id).text(text);
        }

        function displayWinMoney(){
            var five = parseInt($('#five').text())* 5000;
            var four = parseInt($('#four').text())* 50000;
            var three = parseInt($('#three').text())* 1000000;
            var two = parseInt($('#two').text())* 50000000;
            var one = parseInt($('#one').text())* 2000000000;

            $('#winMoney').text((five + four + three + two + one).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + " 원");
        }

        function displayLoseMoney(){
            var totalMoney = parseInt($('#money').text().replace(/[^0-9]/g,''));
            var winMoney = parseInt($('#winMoney').text().replace(/[^0-9]/g,''));
            $('#loseMoney').text((totalMoney - winMoney).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + " 원");
        }

        Array.prototype.contains = function(element) {
            for (var i = 0; i < this.length; i++) {
                if (this[i] == element) {
                    return true;
                }
            }
            return false;
        }
    </script>
</head>
<body>
<div class="container">
<div class="btn-group">
    <button id="startBtn" class="btn btn-primary btn-sm">시작</button>
    <button id="stopBtn" class="btn btn-default btn-sm">정지</button>
    <button id="resetBtn" class="btn btn-default btn-sm">초기화</button>
</div>
<table class="table table-bordered">
    <colgroup>
        <col width="13%">
        <col width="17%">
        <col width="*">
        <col width="*">
    </colgroup>
    <tr>
        <td colspan="4">1등 번호 : <span id="realNums" class="label label-primary"></span></td>
    </tr>
    <tr id="winHold">
        <td colspan="2">
            1등 번호 선택
        </td>
        <td colspan="2">
            <div class="form-group has-success has-feedback">
                <div class="input-group">
                    <select id="win1">
                        <option value="">1등 번호1</option>
                    </select>
                    <select id="win2">
                        <option value="">1등 번호2</option>
                    </select>
                    <select id="win3">
                        <option value="">1등 번호3</option>
                    </select>
                    <select id="win4">
                        <option value="">1등 번호4</option>
                    </select>
                    <select id="win5">
                        <option value="">1등 번호5</option>
                    </select>
                    <select id="win6">
                        <option value="">1등 번호6</option>
                    </select>
                    + 보너스
                    <select id="win7">
                        <option value="">보너스</option>
                    </select>
                </div>
            </div>
            <div class="btn-group">
                <button id="saveWinBtn" class="btn btn-primary btn-sm">1등번호적용</button>
                <button id="reloadWinBtn" class="btn btn-default btn-sm">1등자동생성</button>
            </div>
        </td>
    </tr>
    <tr>
        <td colspan="4">
            게임수 : <span id="count" class="label label-info"></span><br>
            생성 번호 : <span id="nowNums" class="label label-primary"></span>
        </td>
    </tr>
    <tr id="randHold">
        <td colspan="2">
            고정번호 선택
        </td>
        <td colspan="2">
            <div class="form-group has-success has-feedback">
                <div class="input-group">
                    <select id="hold1">
                        <option value="">고정 번호1</option>
                    </select>
                    <select id="hold2">
                        <option value="">고정 번호2</option>
                    </select>
                    <select id="hold3">
                        <option value="">고정 번호3</option>
                    </select>
                    <select id="hold4">
                        <option value="">고정 번호4</option>
                    </select>
                    <select id="hold5">
                        <option value="">고정 번호5</option>
                    </select>
                    <select id="hold6">
                        <option value="">고정 번호6</option>
                    </select>
                    </div>
                </div>
        </td>
    </tr>
    <tr>
        <td colspan="4">
            총 사용 금액 : <span id="money" class="label label-default"></span><br>
            총 당첨 금액 : <span id="winMoney" class="label label-primary">0</span> <br>
            총 피해 금액 : <span id="loseMoney" class="label label-danger">0</span>
        </td>
    </tr>
    <tr>
        <td>등수</td>
        <td>당첨수</td>
        <td>확률</td>
        <td>최근당첨번호</td>
    </tr>
    <tr>
        <td>1등</td>
        <td><span id="one" class="label label-info">0</span></td>
        <td><span id="onePer" class="label label-success">0%</span></td>
        <td><span id="oneMatch" class="label label-primary"></span></td>
    </tr>
    <tr>
        <td>2등</td>
        <td><span id="two" class="label label-info">0</span></td>
        <td><span id="twoPer" class="label label-success">0%</span></td>
        <td><span id="twoMatch" class="label label-primary"></span></td>
    </tr>
    <tr>
        <td>3등</td>
        <td><span id="three" class="label label-info">0</span></td>
        <td><span id="threePer" class="label label-success">0%</span></td>
        <td><span id="threeMatch" class="label label-primary"></span></td>
    </tr>
    <tr>
        <td>4등</td>
        <td><span id="four" class="label label-info">0</span></td>
        <td><span id="fourPer" class="label label-success">0%</span></td>
        <td><span id="fourMatch" class="label label-primary"></span></td>
    </tr>
    <tr>
        <td>5등</td>
        <td><span id="five" class="label label-info">0</span></td>
        <td><span id="fivePer" class="label label-success">0%</span></td>
        <td><span id="fiveMatch" class="label label-primary"></span></td>
    </tr>
    <tr>
        <td>꽝</td>
        <td><span id="none" class="label label-info">0</span></td>
        <td><span id="nonePer" class="label label-success">0%</span></td>
        <td></td>
    </tr>
</table>
</div>
</body>
</html>
